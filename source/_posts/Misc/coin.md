---
title: 硬币连续出现N次正面的期望
date: 2026-1-12 00:17:47
mathjax: true
tags:
  - PE
  - Math
categories:
  - Puzzle
---

## 题目描述

投掷一枚正面概率为$p$的偏硬币。设 $T$ 为首次出现 **连续 $N$ 次正面**（记作 $H^N$）所需的抛掷次数，求 $\mathbb E[T]$。

当硬币公平时，$p=\frac12$。

<!-- more -->

## 题解：切段方法

**一旦出现反面，连续正面计数立刻清零，后续过程与“从头开始”完全同分布**。因此可以把过程按“反面”切成一段一段来分析。

### 状态定义

令硬币正面概率为 $p$，反面概率为 $q=1-p$。

从“干净状态”（刚开始或刚出现过反面、当前连续正面数为 0）出发，考虑“直到第一次出现反面”为止这一段：

- 定义随机变量 $R$：在这一次反面出现之前，连续出现的正面个数（可为 0）。
  - 比如序列以 $T$ 开头，则 $R=0$；
  - 以 $HT$ 开头，则 $R=1$；
  - 以 $HHT$ 开头，则 $R=2$，以此类推。

显然对 $r\ge 0$：

$$
\Pr(R=r)=p^r q
$$

并且

$$
\Pr(R\ge N)=p^N
$$

（只要前 $N$ 次都是正面即可。）

设 $\mathbb E[T]=E$，即从干净状态到首次出现 $H^N$ 的期望抛掷次数。

---

### $E$的方程

讨论第一段的两种情况：

- 成功：如果 $R\ge N$，说明前 $N$ 次全是正面，我们会在第 $N$ 次抛掷立刻停止，因此贡献次数为 $N$。
- 失败：如果 $R=r<N$，这一段形如 $H^rT$，长度为 $r+1$。最后出现反面后回到干净状态，后面还需要期望 $E$ 次。

因此有期望方程：

$$
E=\sum_{r=0}^{N-1}\Pr(R=r)\cdot (r+1+E)\;+\;\Pr(R\ge N)\cdot N
$$

代入概率：

$$
E=\sum_{r=0}^{N-1} p^r q\,(r+1+E) + p^N\cdot N
$$

解出 $E$：

$$
\boxed{\mathbb E[T]=\frac{1-p^N}{(1-p)p^N}}
$$

---

#### 公平硬币 $p=\frac12$ 的结果

当 $p=\frac12$ 时：

$$
\mathbb E[T]=\frac{1-2^{-N}}{(1/2)\cdot 2^{-N}}
=2^{N+1}-2
$$

例如 $N=3$ 时为 $2^4-2=14$。

---
